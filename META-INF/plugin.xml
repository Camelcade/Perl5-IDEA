<!--
  ~ Copyright 2015 Alexandr Evstigneev
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<idea-plugin version="2">
    <id>com.perl5</id>
    <name>Camelcade</name>
    <version>0.33 beta</version>
    <vendor email="hurricup@evstigneev.com" url="http://www.evstigneev.com">Alexandr Evstigneev</vendor>

    <description><![CDATA[
      Perl5 support for Intellij IDEA
    ]]></description>

    <change-notes><![CDATA[
      <p>0.33 beta changes:</p>
      <ul>
      <li>We now have a <a href="https://twitter.com/CamelcadeIDE">twitter account</a> for interactions. Don't forget to subscribe and interact :)</li>
      <li>Implemented MRO for fancy methods invocation: <code>method Package();</code></li>
      <li>Implemented fancy methods invocation inspection and quickfix.</li>
      <li>Implemented the <a href="http://perldoc.perl.org/perlsyn.html#The-Ellipsis-Statement">ellipsis statement</a> from 5.12, annotated as fixme/todo.</li>
      <li>Implemented go-to file on string text click. If string content looks like a file path (even partial), IDEA will jump to a matching file or offer you possible matches.</li>
      <li>Implemented unused lexical variable inspection.</li>
      <li>Disabled collapsing of pragma and version usages.</li>
      <li>Disabled collapsing of line comments with fixme/todo words.</li>
      <li>Go to sub declaration click prefers definition over declaration if only both are resolved.</li>
      <li>Implemented <code>use strict;</code> inspection and quickfix.</li>
      <li>Implemented <code>use warnings;</code> inspection and quickfix to add <code>use warnings FATAL => 'all';</code>.</li>
      <li>Implemented convert to heredoc intention action. You may now convert any string to heredoc in one click.</li>
      <li>New Perl File actions are now in separate groups of main New file menu.</li>
      </ul>

    ]]>
    </change-notes>

    <!-- please see http://confluence.jetbrains.com/display/IDEADEV/Build+Number+Ranges for description -->
    <idea-version since-build="131"/>

    <!-- please see http://confluence.jetbrains.com/display/IDEADEV/Plugin+Compatibility+with+IntelliJ+Platform+Products
         on how to target different products -->

    <depends>com.intellij.modules.lang</depends>

    <extensions defaultExtensionNs="com.intellij">

        <internalFileTemplate name="Perl5 package"/>
        <internalFileTemplate name="Perl5 script"/>
        <internalFileTemplate name="Perl5 embedded"/>

        <createFromTemplateHandler implementation="com.perl5.lang.perl.idea.filetemplates.PerlCreatePackageFromTemplateHandler" />


        <languageInjector implementation="com.perl5.lang.perl.idea.intellilang.PerlLanguageInjector"/>


        <fileTypeDetector implementation="com.perl5.PerlFileTypeDetector"/>

        <errorHandler implementation="com.intellij.diagnostic.ITNReporter"/>
        <sdkType implementation="com.perl5.lang.perl.idea.sdk.PerlSdkType"/>
        <moduleType id="PERL5_MODULE" implementationClass="com.perl5.lang.perl.idea.modules.PerlModuleType"/>
        <moduleConfigurationEditorProvider implementation="com.perl5.lang.perl.idea.modules.PerlModuleConfigurationEditorProvider" order="first"/>

        <fileTypeFactory implementation="com.perl5.PerlTypeFactory"/>

        <lang.parserDefinition language="Perl5" implementationClass="com.perl5.lang.perl.PerlParserDefinition"/>
        <lang.syntaxHighlighterFactory key="Perl5" implementationClass="com.perl5.lang.perl.idea.highlighter.PerlSyntaxHighlighterFactory"/>
        <annotator language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlAnnotatorSyntax"/>
        <completion.contributor language="Perl5" implementationClass="com.perl5.lang.perl.idea.completion.PerlCompletionContributor"/>
        <lang.foldingBuilder language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlFoldingBuilder"/>
        <lang.commenter language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlCommenter"/>
        <lang.braceMatcher language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlBraceMatcher"/>
        <lang.ast.factory language="Perl5" implementationClass="com.perl5.lang.perl.psi.utils.PerlASTFactory" order="first"/>
        <psi.referenceContributor implementation="com.perl5.lang.perl.psi.references.PerlReferenceContributor"/>
        <elementDescriptionProvider implementation="com.perl5.lang.perl.idea.PerlElementDescriptionProvider"/>
        <lang.refactoringSupport language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlRefactoringSupportProvider"/>
        <gotoClassContributor implementation="com.perl5.lang.perl.idea.gotosearch.PerlGoToClassContributor" />
        <gotoDeclarationHandler implementation="com.perl5.lang.perl.idea.PerlGotoDeclarationHandler" />
        <weigher key="completion" implementationClass="com.perl5.lang.perl.idea.PerlCompletionWeighter" order="first"/>
        <lang.namesValidator language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlNamesValidator"/>


        <quoteHandler fileType="Perl5 script" className="com.perl5.lang.perl.idea.editor.PerlQuoteHandler"/>


        <lang.elementManipulator forClass="com.perl5.lang.perl.psi.impl.PerlHeredocElementImpl" order="first" implementationClass="com.perl5.lang.perl.idea.editor.PerlPsiHeredocManipulator"/>

        <moveFileHandler implementation="com.perl5.lang.perl.idea.refactoring.PerlMoveFileHandler"/>

        <renamePsiElementProcessor implementation="com.perl5.lang.perl.idea.refactoring.PerlRenameNamespaceProcessor"/>
        <renamePsiElementProcessor implementation="com.perl5.lang.perl.idea.refactoring.PerlRenameFileProcessor"/>
        <renamePsiElementProcessor implementation="com.perl5.lang.perl.idea.refactoring.PerlRenameHeredocProcessor"/>
        <renamePsiElementProcessor implementation="com.perl5.lang.perl.idea.refactoring.PerlRenameVariableProcessor"/>

        <nameSuggestionProvider implementation="com.perl5.lang.perl.idea.refactoring.PerlNameSuggestionProvider" order="first"/>

        <defaultLiveTemplatesProvider implementation="com.perl5.lang.perl.idea.livetemplates.PerlDefaultTemplatesProvider"/>
        <liveTemplateContext implementation="com.perl5.lang.perl.idea.livetemplates.PerlTemplateContextType$Generic"/>
        <liveTemplateContext implementation="com.perl5.lang.perl.idea.livetemplates.PerlTemplateContextType$Postfix"/>
        <liveTemplateContext implementation="com.perl5.lang.perl.idea.livetemplates.PerlTemplateContextType$Prefix"/>

        <!--<renameInputValidator implementation="com.perl5.lang.perl.idea.PerlRenameInputValidator"/>-->

        <stubElementTypeHolder class="com.perl5.lang.perl.idea.stubs.PerlStubElementTypes"/>

        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.variables.PerlScalarsStubIndex"/>
        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.variables.PerlArraysStubIndex"/>
        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.variables.PerlHashesStubIndex"/>

        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.globs.PerlGlobsStubIndex"/>
        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.subsdefinitions.PerlSubDefinitionsStubIndex"/>
        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.subsdeclarations.PerlSubDeclarationStubIndex"/>
        <stubIndex implementation="com.perl5.lang.perl.idea.stubs.namespaces.PerlNamespaceDefinitionStubIndex"/>

        <lang.findUsagesProvider language="Perl5" implementationClass="com.perl5.lang.perl.idea.findusages.PerlFindUsagesProvider"/>

        <!--codeInsight.lineMarkerProvider language="Perl5" implementationClass="com.perl5.lang.perl.idea.PerlLineMarkerProvider"/-->

        <lang.parserDefinition language="Embedded Perl" implementationClass="com.perl5.lang.embedded.EmbeddedPerlParserDefinition"/>
        <lang.fileViewProviderFactory language="Embedded Perl"
                                      implementationClass="com.perl5.lang.embedded.EmbeddedPerlFileViewProviderFactory"/>
        <lang.syntaxHighlighterFactory key="Embedded Perl" implementationClass="com.perl5.lang.embedded.idea.EmbeddedPerlSyntaxHighlighterFactory"/>
        <lang.foldingBuilder language="Embedded Perl" implementationClass="com.perl5.lang.perl.idea.PerlFoldingBuilder"/>
        <lang.commenter language="Embedded Perl" implementationClass="com.perl5.lang.perl.idea.PerlCommenter"/>
        <lang.findUsagesProvider language="Embedded Perl" implementationClass="com.perl5.lang.embedded.idea.EmbeddedPerlFindUsagesProvider"/>
        <lang.namesValidator language="Embedded Perl" implementationClass="com.perl5.lang.perl.idea.PerlNamesValidator"/>


        <lang.parserDefinition language="Perl5 POD" implementationClass="com.perl5.lang.pod.PodParserDefinition"/>
        <lang.syntaxHighlighterFactory key="Perl5 POD" implementationClass="com.perl5.lang.pod.idea.highlighter.PodSyntaxHighlighterFactory"/>


        <additionalTextAttributes scheme="Default" file="colorSchemes/npp_default.xml"/>
        <additionalTextAttributes scheme="Default" file="colorSchemes/pod_default.xml"/>

        <colorSettingsPage implementation="com.perl5.lang.perl.idea.highlighter.PerlColorSettingsPage"/>
        <colorSettingsPage implementation="com.perl5.lang.pod.idea.highlighter.PodColorSettingsPage"/>

        <localInspection language="Perl5"
                         shortName="PackageFileMissing" displayName="Missing package file" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlPackageFileMissingInspection" />

        <localInspection language="Perl5"
                         shortName="NamespaceUndefined" displayName="Unresovable namespace" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlNamespaceUndefinedInspection" />
        <localInspection language="Perl5"
                         shortName="NamespaceClashes" displayName="Clashed namespace definition" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlNamespaceClashesInspection" />
        <localInspection language="Perl5"
                         shortName="NamespaceMultipleDefinitions" displayName="Multiple namespace definitions" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlNamespaceMultipleDefinitionsInspection" />

        <localInspection language="Perl5"
                         shortName="FancyMethodCall" displayName="Fancy method calls" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlFancyMethodCallInspection" />

        <localInspection language="Perl5"
                         shortName="SubDeprecated" displayName="Deprecated sub" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlSubDeprecatedInspection" />
        <localInspection language="Perl5"
                         shortName="SubUnresolvable" displayName="Unresolvable sub" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlSubUnresolvableInspection" />
        <localInspection language="Perl5"
                         shortName="SubMultipleDeclarations" displayName="Multiple sub declarations" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlSubMultipleDeclarationsInspection" />
        <localInspection language="Perl5"
                         shortName="SubMultipleDefinitions" displayName="Multiple sub definitions" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlSubMultipleDefinitionsInspection" />

        <localInspection language="Perl5"
                         shortName="VariableUnresolvable" displayName="Unresolvable variable" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlVariableUnresolvableInspection" />
        <localInspection language="Perl5"
                         shortName="VariableShadows" displayName="Variables shadowing" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlVariableShadowingInspection" />
        <localInspection language="Perl5"
                         shortName="VariableLexicalBuiltIn" displayName="Lexical built-in declarations" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlVariableBuiltinRedeclarationInspection" />
        <localInspection language="Perl5"
                         shortName="UnusedLexicalVariable" displayName="Unused lexical variables" groupName="Perl5" enabledByDefault="true" level="WARNING"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlUnusedLexicalVariableInspection" />

        <localInspection language="Perl5"
                         shortName="UseStrict" displayName="Pragma usage: strict" groupName="Perl5" enabledByDefault="true" level="ERROR"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlUseStrictInspection" />
        <localInspection language="Perl5"
                         shortName="UseWarnings" displayName="Pragma usage: warnings" groupName="Perl5" enabledByDefault="true" level="ERROR"
                         implementationClass="com.perl5.lang.perl.idea.inspections.PerlUseWarningsInspection" />

        <intentionAction>
            <className>com.perl5.lang.perl.idea.intentions.StringToHeredocConverter</className>
            <category>String converter</category>
            <descriptionDirectoryName>StringToHeredocConverter</descriptionDirectoryName>

        </intentionAction>


    </extensions>

    <application-components>
    </application-components>

    <project-components>
        <!-- Add your project components here -->
        <component>
            <implementation-class>com.perl5.lang.perl.idea.components.PerlProjectComponent</implementation-class>
        </component>
    </project-components>

    <actions>
        <group class="com.perl5.lang.perl.idea.actions.groups.PerlFileActionsGroup" id="Perl5NewFile" text="Perl5 File Actions" description="Create Perl5 File" icon="com/perl5/icons/perl5.png">

            <action id="Perl5.NewPerlPackage" class="com.perl5.lang.perl.idea.actions.CreatePerlPackageFileAction"
                    text="Perl5 Package" description="Create Perl5 Package">
            </action>

            <action id="Perl5.NewPerlScript" class="com.perl5.lang.perl.idea.actions.CreatePerlScriptFileAction"
                    text="Perl5 Script" description="Create Perl5 Script">
            </action>

            <action id="Perl5.NewPerlEmbedded" class="com.perl5.lang.perl.idea.actions.CreateEmbeddedPerlFileAction"
                    text="Embedded Perl5 File" description="Create Embedded Perl5 file">
            </action>

            <separator/>

            <add-to-group group-id="NewGroup" anchor="first"/>
        </group>

    </actions>

</idea-plugin>