Subtree: HTML (HTML)
HtmlFile:issue1262v2.tt
  PsiElement(HTML_DOCUMENT)
    PsiElement(XML_PROLOG)
      <empty list>
    HtmlTag:script
      XmlToken:XML_START_TAG_START('<')
      XmlToken:XML_NAME('script')
      PsiElement(XML_ATTRIBUTE)
        XmlToken:XML_NAME('type')
        XmlToken:XML_EQ('=')
        PsiElement(XML_ATTRIBUTE_VALUE)
          XmlToken:XML_ATTRIBUTE_VALUE_START_DELIMITER('"')
          XmlToken:XML_ATTRIBUTE_VALUE_TOKEN('text/javascript')
          XmlToken:XML_ATTRIBUTE_VALUE_END_DELIMITER('"')
      XmlToken:XML_TAG_END('>')
      XmlText
        XmlToken:XML_DATA_CHARACTERS('\n    var a = 5;\n    if(')
        PsiElement(TT2: TT2_OUTER)('[% b %]')
        XmlToken:XML_DATA_CHARACTERS(' <= a) {\n        console.log("Hello world");\n    }\n')
      XmlToken:XML_END_TAG_START('</')
      XmlToken:XML_NAME('script')
      XmlToken:XML_TAG_END('>')
    HtmlTag:script
      XmlToken:XML_START_TAG_START('<')
      XmlToken:XML_NAME('script')
      PsiElement(XML_ATTRIBUTE)
        XmlToken:XML_NAME('type')
        XmlToken:XML_EQ('=')
        PsiElement(XML_ATTRIBUTE_VALUE)
          XmlToken:XML_ATTRIBUTE_VALUE_START_DELIMITER('"')
          XmlToken:XML_ATTRIBUTE_VALUE_TOKEN('text/javascript')
          XmlToken:XML_ATTRIBUTE_VALUE_END_DELIMITER('"')
      XmlToken:XML_TAG_END('>')
      XmlText
        XmlToken:XML_DATA_CHARACTERS('\n    var a = 5;\n    if(\n')
        PsiElement(TT2: TT2_OUTER)('%% b\n')
        XmlToken:XML_DATA_CHARACTERS('        <= a) {\n        console.log("Hello world");\n    }\n')
      XmlToken:XML_END_TAG_START('</')
      XmlToken:XML_NAME('script')
      XmlToken:XML_TAG_END('>')
    HtmlTag:script
      XmlToken:XML_START_TAG_START('<')
      XmlToken:XML_NAME('script')
      PsiElement(XML_ATTRIBUTE)
        XmlToken:XML_NAME('type')
        XmlToken:XML_EQ('=')
        PsiElement(XML_ATTRIBUTE_VALUE)
          XmlToken:XML_ATTRIBUTE_VALUE_START_DELIMITER('"')
          XmlToken:XML_ATTRIBUTE_VALUE_TOKEN('text/javascript')
          XmlToken:XML_ATTRIBUTE_VALUE_END_DELIMITER('"')
      XmlToken:XML_TAG_END('>')
      XmlText
        XmlToken:XML_DATA_CHARACTERS('\n    ')
        PsiElement(TT2: TT2_OUTER)('[% comments = 1 %]\n    [% IF comments # some comment here %]')
        XmlToken:XML_DATA_CHARACTERS('\n    //javacript comment\n    ')
        PsiElement(TT2: TT2_OUTER)('[% END %]')
        XmlToken:XML_DATA_CHARACTERS('\n\n    function calculate(a){\n        ')
        PsiElement(TT2: TT2_OUTER)('[% IF negative %]')
        XmlToken:XML_DATA_CHARACTERS('\n        if( a < 0){\n            alert('Negative');\n            return false;\n        }\n        ')
        PsiElement(TT2: TT2_OUTER)('[% END %]')
        XmlToken:XML_DATA_CHARACTERS('\n        return a+10;\n    }\n\n')
      XmlToken:XML_END_TAG_START('</')
      XmlToken:XML_NAME('script')
      XmlToken:XML_TAG_END('>')
--------------------------------------------------------------------------------
Subtree: Template Toolkit 2 (Template Toolkit 2)
Template Toolkit File
  PsiComment(TT2: TT2_HTML)('<script type="text/javascript">\n    var a = 5;\n    if(')
  PsiElement(TT2: [%)('[%')
  PsiGetDirectiveImpl(TT2: GET_DIRECTIVE)
    PsiIdentifierExprImpl(TT2: IDENTIFIER_EXPR)
      PsiElement(TT2: TT2_IDENTIFIER)('b')
  PsiElement(TT2: %])('%]')
  PsiComment(TT2: TT2_HTML)(' <= a) {\n        console.log("Hello world");\n    }\n</script>\n\n\n<script type="text/javascript">\n    var a = 5;\n    if(\n')
  PsiElement(TT2: %%)('%%')
  PsiGetDirectiveImpl(TT2: GET_DIRECTIVE)
    PsiIdentifierExprImpl(TT2: IDENTIFIER_EXPR)
      PsiElement(TT2: TT2_IDENTIFIER)('b')
  PsiComment(TT2: TT2_HTML)('        <= a) {\n        console.log("Hello world");\n    }\n</script>\n\n<script type="text/javascript">\n    ')
  PsiElement(TT2: [%)('[%')
  PsiSetDirectiveImpl(TT2: SET_DIRECTIVE)
    PsiAssignExprImpl(TT2: ASSIGN_EXPR)
      PsiIdentifierExprImpl(TT2: IDENTIFIER_EXPR)
        PsiElement(TT2: TT2_IDENTIFIER)('comments')
      PsiElement(TT2: =)('=')
      PsiTermExprImpl(TT2: TERM_EXPR)
        PsiElement(TT2: TT2_NUMBER_SIMPLE)('1')
  PsiElement(TT2: %])('%]')
  PsiIfBlockImpl(TT2: IF_BLOCK)
    PsiIfBranchImpl(TT2: IF_BRANCH)
      PsiElement(TT2: [%)('[%')
      PsiIfDirectiveImpl(TT2: IF_DIRECTIVE)
        PsiElement(TT2: IF)('IF')
        PsiIdentifierExprImpl(TT2: IDENTIFIER_EXPR)
          PsiElement(TT2: TT2_IDENTIFIER)('comments')
      PsiComment(TT2: LINE_COMMENT)('# some comment here ')
      PsiElement(TT2: %])('%]')
      PsiComment(TT2: TT2_HTML)('\n    //javacript comment\n    ')
    PsiElement(TT2: [%)('[%')
    PsiEndDirectiveImpl(TT2: END_DIRECTIVE)
      PsiElement(TT2: END)('END')
    PsiElement(TT2: %])('%]')
  PsiComment(TT2: TT2_HTML)('\n\n    function calculate(a){\n        ')
  PsiIfBlockImpl(TT2: IF_BLOCK)
    PsiIfBranchImpl(TT2: IF_BRANCH)
      PsiElement(TT2: [%)('[%')
      PsiIfDirectiveImpl(TT2: IF_DIRECTIVE)
        PsiElement(TT2: IF)('IF')
        PsiIdentifierExprImpl(TT2: IDENTIFIER_EXPR)
          PsiElement(TT2: TT2_IDENTIFIER)('negative')
      PsiElement(TT2: %])('%]')
      PsiComment(TT2: TT2_HTML)('\n        if( a < 0){\n            alert('Negative');\n            return false;\n        }\n        ')
    PsiElement(TT2: [%)('[%')
    PsiEndDirectiveImpl(TT2: END_DIRECTIVE)
      PsiElement(TT2: END)('END')
    PsiElement(TT2: %])('%]')
  PsiComment(TT2: TT2_HTML)('\n        return a+10;\n    }\n\n</script>')
--------------------------------------------------------------------------------
